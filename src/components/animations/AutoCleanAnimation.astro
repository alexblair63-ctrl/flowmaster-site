---
interface Props {
  class?: string;
}
const { class: className = '' } = Astro.props;
---

<svg
  viewBox="0 0 200 200"
  class={`autoclean-svg ${className}`}
  xmlns="http://www.w3.org/2000/svg"
>
  <!-- Storage bar background -->
  <rect x="40" y="130" width="120" height="20" fill="#252525" rx="4" stroke="#6be553" stroke-width="2"/>

  <!-- Storage bar fill (shrinks) -->
  <rect class="storage-fill" x="44" y="134" width="80" height="12" fill="#4fb83d" rx="2" opacity="0.8"/>

  <!-- File icons that fade out -->
  <g class="files">
    <!-- File 1 -->
    <g class="file file-1">
      <rect x="50" y="60" width="30" height="40" fill="#1a1a1a" rx="3"/>
      <rect x="50" y="60" width="30" height="10" fill="#4fb83d" rx="3" opacity="0.5"/>
    </g>

    <!-- File 2 -->
    <g class="file file-2">
      <rect x="85" y="50" width="30" height="40" fill="#1a1a1a" rx="3"/>
      <rect x="85" y="50" width="30" height="10" fill="#4fb83d" rx="3" opacity="0.5"/>
    </g>

    <!-- File 3 -->
    <g class="file file-3">
      <rect x="120" y="65" width="30" height="40" fill="#1a1a1a" rx="3"/>
      <rect x="120" y="65" width="30" height="10" fill="#4fb83d" rx="3" opacity="0.5"/>
    </g>
  </g>

  <!-- Checkmark (appears after clean) -->
  <path
    class="checkmark"
    d="M90 100 L98 110 L115 88"
    fill="none"
    stroke="#6be553"
    stroke-width="4"
    stroke-linecap="round"
    stroke-linejoin="round"
    opacity="0"
  />
</svg>

<style>
  .autoclean-svg .file {
    animation: file-fade 3s ease-in-out infinite;
    animation-play-state: paused;
  }

  .autoclean-svg .file-1 { animation-delay: 0s; }
  .autoclean-svg .file-2 { animation-delay: 0.4s; }
  .autoclean-svg .file-3 { animation-delay: 0.8s; }

  .autoclean-svg .storage-fill {
    animation: shrink-bar 3s ease-in-out infinite;
    animation-play-state: paused;
  }

  .autoclean-svg .checkmark {
    animation: show-check 3s ease-in-out infinite;
    animation-play-state: paused;
  }

  :global(.animate-active) .autoclean-svg .file,
  :global(.animate-active) .autoclean-svg .storage-fill,
  :global(.animate-active) .autoclean-svg .checkmark,
  :global(.step-card:hover) .autoclean-svg .file,
  :global(.step-card:hover) .autoclean-svg .storage-fill,
  :global(.step-card:hover) .autoclean-svg .checkmark {
    animation-play-state: running;
  }

  @keyframes file-fade {
    0%, 20% { opacity: 1; transform: translateY(0); }
    50% { opacity: 0; transform: translateY(-15px); }
    100% { opacity: 1; transform: translateY(0); }
  }

  @keyframes shrink-bar {
    0%, 20% { width: 80px; }
    60%, 80% { width: 30px; }
    100% { width: 80px; }
  }

  @keyframes show-check {
    0%, 50% { opacity: 0; }
    65%, 85% { opacity: 1; }
    100% { opacity: 0; }
  }
</style>
